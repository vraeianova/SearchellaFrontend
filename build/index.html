<!--
=========================================================
* Soft UI Dashboard Tailwind - v1.0.4
=========================================================

* Product Page: https://www.creative-tim.com/product/soft-ui-dashboard-tailwind
* Copyright 2022 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png" />
    <link rel="icon" type="image/png" href="./assets/img/favicon.png" />
    <title>Searchella</title>
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
    <!-- Font Awesome Icons -->
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
    <!-- Nucleo Icons -->
    <link href="./assets/css/nucleo-icons.css" rel="stylesheet" />
    <link href="./assets/css/nucleo-svg.css" rel="stylesheet" />
    <!-- Popper -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <!-- Main Styling -->
    <link href="./assets/css/soft-ui-dashboard-tailwind.css?v=1.0.4" rel="stylesheet" />    
  </head>

  <body class="m-0 font-sans antialiased font-normal text-base leading-default bg-gray-50 text-slate-500">
    <!-- sidenav  -->
    

    <!-- end sidenav -->

    <main class="ease-soft-in-out  relative h-full max-h-screen rounded-xl transition-all duration-200">
      

      <div id="app" class="w-full px-6 py-6 mx-auto">
        <!-- cards row 2 -->
        <div class="flex flex-wrap mt-6 -mx-3">
          <div class="w-full px-3 mb-6 lg:mb-0 lg:w-12/12 lg:flex-none">
            <div class="relative flex flex-col min-w-0 break-words bg-white shadow-soft-xl rounded-2xl bg-clip-border">
              <div class="flex-auto p-4">
                <div class="flex flex-wrap mt-4 -mx-3">
                    <div class="w-full max-w-full px-3 flex-0 sm:w-6/12">
                        <h5 class="font-bold">Start search!</h5>
                      <input placeholder=  "Write an email and press Enter for search!" v-on:keydown="handleKeydown" id="searchPhrase" type="text" name="searchPhrase" placeholder="" class="focus:shadow-soft-primary-outline dark:bg-gray-950 dark:placeholder:text-white/80 dark:text-white/80 text-sm leading-5.6 ease-soft block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none transition-all placeholder:text-gray-500 focus:border-fuchsia-300 focus:outline-none">
                    </div>
                    <div class="w-full max-w-full px-3 flex-0 sm:mt-0 sm:w-6/12">
                       
                    </div>
                    </div>
              </div>
            </div>
          </div>          
        </div>
        
        <div class="flex flex-wrap my-6 -mx-3">
          <!-- card 1 -->

          <div class="w-full max-w-full px-3 mt-0 mb-6 md:mb-0 md:w-1/2 md:flex-none lg:w-2/3 lg:flex-none">
            <div class="border-black/12.5 shadow-soft-xl relative flex min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border">
              <div class="border-black/12.5 mb-0 rounded-t-2xl border-b-0 border-solid bg-white p-6 pb-0">
                <div class="flex flex-wrap mt-0 -mx-3">
                  <div class="flex-none w-7/12 max-w-full px-3 mt-0 lg:w-1/2 lg:flex-none">
                    <h6>Search results</h6>
                    
                  </div>
                  <div class="flex-none w-5/12 max-w-full px-3 my-auto text-right lg:w-1/2 lg:flex-none">
                    
                  </div>
                </div>
              </div>
              <div class="flex-auto p-6 px-0 pb-2">
                <div class="overflow-x-auto">
                  <table class="items-center w-full mb-0 align-top border-gray-200 text-slate-500">
                    <thead class="align-bottom">
                      <tr>
                        <th class="px-6 py-3 font-bold tracking-normal text-left uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">Subject</th>
                        <th class="px-6 py-3 pl-2 font-bold tracking-normal text-left uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">From</th>
                        <th class="px-6 py-3 font-bold tracking-normal text-center uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">To</th>
                      </tr>
                    </thead>
                    <tbody>

                      <tr v-for="(item, index) in mailResults" @click="getMessage(item._id)">
                        <td class="p-2 align-middle bg-transparent border-b whitespace-nowrap">
                          <div class="flex px-2 py-1">
                            <div class="flex flex-col justify-center">
                              <h6 class="mb-0 leading-normal text-sm">[[item._source.Subject]]</h6>
                            </div>
                          </div>
                        </td>
                       
                        <td class="p-2 align-middle bg-transparent border-b whitespace-nowrap dark:border-white/40">
                            <p class="mb-0 leading-normal text-sm text-slate-400 dark:text-white/80">[[item._source.From]]</p>
                        </td>
                        <td class="p-2 align-middle bg-transparent border-b whitespace-nowrap dark:border-white/40">
                            <p class="mb-0 leading-normal text-sm text-slate-400 dark:text-white/80">[[item._source.To]]</p>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- card 2 -->

          <div class="w-full max-w-full px-3 md:w-1/2 md:flex-none lg:w-1/3 lg:flex-none">
            <div class="border-black/12.5 shadow-soft-xl relative flex h-full min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border">
              <div class="border-black/12.5 mb-0 rounded-t-2xl border-b-0 border-solid bg-white p-6 pb-0">
                <h6>Message</h6>
                <div id="message">
                    
                </div>
              </div>
              
            </div>
          </div>
        </div>

        <footer class="pt-4">
          <div class="w-full px-6 mx-auto">
            <div class="flex flex-wrap items-center -mx-3 lg:justify-between">
              <div class="w-full max-w-full px-3 mt-0 mb-6 shrink-0 lg:mb-0 lg:w-1/2 lg:flex-none">
                <div class="leading-normal text-center text-sm text-slate-500 lg:text-left">
                  Â©
                  <span id="date"> </span>
                 
                  Modified with <i class="fa fa-heart"></i> by
                  <a href="https://github.com/vraeianova" class="font-semibold text-slate-700" target="_blank">Cris</a>
                  
                </div>
              </div>
              
            </div>
          </div>
        </footer>
      </div>
    </main>
    
  </body>

  <script src="./assets/js/soft-ui-dashboard-tailwind.js?v=1.0.4" async></script>

  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
	const vm = Vue.createApp({
		delimiters: ["[[", "]]"],
		data(){
			return {
				mailResults:[],
			};
		},
		mounted(){			
			// this.getMail()
			this.dateFunction()
		},

		methods:{
            async getMail(){
                let search_phrase = document.getElementById("searchPhrase");
                console.log('search phrase',search_phrase.value)
                if (search_phrase.value !=""){
                    try {
                        const url= `http://localhost:8080/api/search/${search_phrase.value}/`;
                        const response = await axios.get(url);
                        this.mailResults = response.data.hits.hits;
                        
                    } catch (error) {
                        console.error(error);
                    }
                }
			},
            async getMessage(id){
                let message = this.mailResults.filter(result => result._id  == id );
                let messageEl = document.getElementById("message");
                
                messageEl.innerHTML=message[0]._source.Message

			},
            handleKeydown: function(event){
                if (event.key === 'Enter') {
                    this.getMail();
                }
            },
            dateFunction: function(){
                let dateEl= document.getElementById("date")
                let fullYear = new Date().getFullYear() + ",";
                dateEl.innerHTML=fullYear

            }
		}
		
		
	}).mount("#app")	
</script>
</html>
